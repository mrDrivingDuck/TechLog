# Cryptography - Digital Signature 数字签名

Created by : Mr Dk.

2018 / 11 / 05 10:00

Nanjing, Jiangsu, China

---

## Target

* 保证信息传输的完整性
* 发送者的身份认证
* 防止交易中的抵赖

## 前提概念：[非对称加密算法](https://mrdrivingduck.github.io/#/markdown?repo=notes&path=Cryptography%2FCryptography%20Symmetric%20%26%20Asymmetric%20Encryption.md)

## 前提概念：Digest 数字摘要

一种 __单向、不可逆__ 的加密算法，采用 __单向 hash 函数__ 对报文进行计算，得到报文的摘要。也称为 __指纹 (Finger Print)__ 。

摘要算法的特点：

* 对于不同长度的输入报文，得到的摘要总是固定长度的
* 对于不同的输入，计算出的摘要必须不同；对于相同的输入，计算出的摘要必须相同
  * 发生 __“碰撞”__ 的概率被用于衡量一个 _hash_ 函数的好坏
  * 一般来说需要保证输出长度在 160 bit 以上才能保证安全
* 算法必须单向、不可逆，不可逆向推知输入报文内容

常见算法：

* _MD5 (Message Digest Algorithm 5)_
  * 流行度较高
  * 目前被发现存在碰撞冲突风险
  * 输出长度为 128 bit (16 Bytes)
* _SHA-1 (Security Hash Algorithm)_
  * 输出长度为 160 bit (20 Bytes)
* _SHA-256_
  * 安全性更高
  * 输出长度为 256 bit (32 Bytes)
* ...

## 数字签名

定义了两个互补的运算操作：

* 数字签名 - 一个加密的过程
* 数字签名验证 - 一个解密的过程

## 签名过程

* 发送方使用 _hash_ 函数对报文文本生成 __数字摘要__
* 发送方使用自己的 __私钥__ 对数字摘要进行加密 (签名)
* 将加密后的摘要作为数字签名和报文原文一起发送给接收方
* 接收方使用相同的 _hash_ 函数对报文文本生成数字摘要
* 接收方使用发送方的 __公钥__ 对收到的加密摘要进行解密 (验证签名)
* 接收方对比解密后的摘要和自己生成的摘要是否一致
  * 如果摘要相同，则接收方可确认该数字签名确实来自发送方
  * 因为发送方有独一无二的 __私钥__，否则使用发送方公钥无法解密摘要

---

